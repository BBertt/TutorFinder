import{b as u,j as e,r as h,H as f,a as j}from"./app-CQ6taLAA.js";import{L as g}from"./Layout-C--HrfFV.js";import{V as b}from"./VoteButtons-DnB-e_pz.js";import{P as N}from"./Pagination-CiI_2ZU3.js";import{S as w}from"./SortDropdown-CYP84SkA.js";import"./GuestNavbar-BIHk0iz0.js";import"./SuccessModal-BimQ72Cs.js";function p({forumId:s,parentId:o=null,onSuccess:r=()=>{}}){const{data:t,setData:l,post:a,processing:m,errors:i,reset:d}=u({description:"",parent_id:o}),c=n=>{n.preventDefault(),a(route("forums.replies.store",s),{preserveScroll:!0,onSuccess:()=>{d(),r()}})};return e.jsxs("form",{onSubmit:c,className:"mt-4",children:[e.jsx("textarea",{value:t.description,onChange:n=>l("description",n.target.value),placeholder:"Write a message...",className:"w-full border-gray-200 rounded-lg shadow-sm dark:bg-darkSecondary dark:border-dark dark:text-white dark:placeholder-gray-400",rows:"3"}),i.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.description}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{type:"submit",disabled:m,className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-opacity-80 dark:hover:bg-opacity-80 disabled:opacity-50 text-sm font-semibold",children:"Post Reply"})})]})}const y=s=>{const o=new Date(s),r=Math.floor((new Date-o)/1e3);let t=r/31536e3;return t>1?Math.floor(t)+" years ago":(t=r/2592e3,t>1?Math.floor(t)+" months ago":(t=r/86400,t>1?Math.floor(t)+" days ago":(t=r/3600,t>1?Math.floor(t)+" hours ago":(t=r/60,t>1?Math.floor(t)+" minutes ago":Math.floor(r)+" seconds ago"))))};function x({reply:s,type:o="reply",forumId:r}){const[t,l]=h.useState(!1),[a,m]=h.useState(!1),i=s.all_children&&s.all_children.length>0,d=i?s.all_children.length:0,c=`${s.user.first_name} ${s.user.last_name}`;return e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("img",{className:"w-12 h-12 rounded-full",src:s.user.profile_image_url?s.user.profile_image_url:"/assets/icons/profile.svg",alt:c}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-bold dark:text-white",children:c}),e.jsx("span",{className:"text-xs text-gray-400",children:y(s.created_at)})]}),o==="forum"&&e.jsx("h1",{className:"text-3xl font-bold mt-1 mb-2 dark:text-white",children:s.title}),e.jsx("p",{className:"mt-1 dark:text-white",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsx(b,{item:s,type:o}),o==="reply"&&e.jsx("button",{onClick:()=>l(!t),className:"text-sm font-semibold text-gray-400 hover:underline dark:hover:text-white",children:"Reply"}),i&&e.jsxs("button",{onClick:()=>m(!a),className:"text-sm font-semibold text-primary hover:underline flex items-center space-x-1",children:[e.jsx("img",{src:"/assets/icons/arrow-down-primary.svg",alt:"toggle replies",className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`}),e.jsx("span",{children:a?"Hide Replies":`View ${d} ${d>1?"Replies":"Reply"}`})]})]}),t&&e.jsx(p,{forumId:r,parentId:s.id,onSuccess:()=>l(!1)}),i&&a&&e.jsx("div",{className:"mt-4 pl-6 border-l-2 border-gray-200 dark:border-gray-700 space-y-4",children:s.all_children.map(n=>e.jsx(x,{reply:n,type:"reply",forumId:r},n.id))})]})]})}function k({forum:s,replies:o,filters:r,repliesTotal:t}){const l=a=>{j.get(route("forums.show",s.id),{sort:a},{preserveState:!0,preserveScroll:!0})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{title:s.title}),e.jsx("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md dark:bg-darkSecondary dark:border-dark",children:[e.jsx(x,{reply:s,type:"forum",forumId:s.id}),e.jsxs("div",{className:"mt-12 border-t pt-8 dark:border-dark",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 dark:text-white",children:"Leave a Reply"}),e.jsx(p,{forumId:s.id})]}),e.jsx("hr",{className:"my-8 dark:border-dark"}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold dark:text-white",children:["Replies (",t,")"]}),e.jsx(w,{currentSort:r.sort,onSortChange:l})]}),e.jsx("div",{className:"space-y-6",children:o.data.map(a=>e.jsx(x,{reply:a,type:"reply",forumId:s.id},a.id))}),e.jsx(N,{links:o.links})]})})]})}k.layout=s=>e.jsx(g,{children:s});export{k as default};
